library(aws.s3)
library(here)
library(sf)

source(here("src", "s3_scripts", "s3_secret.r"))
to_b <- "vulnerabilityfidtogo"
from_b <- "vulnerabilitymapping"

# copy over TGO shape but filter the rest out
tgo_shp <- s3read_using(st_read, bucket = from_b,
                        object = "Clean_Data/Spatial_Data/Combined/Raster/combined.geojson") %>%
  filter(ADM_0 == "TGO")

s3write_using(tgo_shp, st_write, bucket = to_b,
              object = "Clean_Data/Spatial_Data/TGO/Raster/tgo.geojson")

# copy other over neccessary objects
tgo_objects <- data.frame(
  obj_name = c("tgo_osm_geo.geojson", "tgo_osm_tab_clean.csv"),
  obj_type = c("Raster", "Vector"),
  clean_status = c("Raw_Data", "Clean_Data")
)

for(i in 1:nrow(tgo_objects)) {
  obj_path <- paste(tgo_objects$clean_status[i], "Spatial_Data/TGO", 
                tgo_objects$obj_type[i], tgo_objects$obj_name[i], sep = "/")
  print(paste("Copying", obj_path))
  copy_object(from_object = obj_path, to_object = obj_path,
              from_bucket = from_b, to_bucket = to_b)
}
  
  
  
  